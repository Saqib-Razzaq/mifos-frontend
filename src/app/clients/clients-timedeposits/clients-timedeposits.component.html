<mat-card class="container">
  <!-- ðŸ”¹ Search Box -->
  <div class="layout-column layout-gt-sm-row align-gt-sm-start-center">
    <div class="search-box m-r-30">
      <mat-form-field class="search-box">
        <input
          matInput
          placeholder="Search by account no, client name, or product"
          class="search-box"
          (keydown.enter)="search($event.target.value)"
        />
      </mat-form-field>
    </div>
  </div>

  <div class="client-list">
    <div *ngIf="isLoading">
      <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    </div>

    <table
      mat-table
      [dataSource]="dataSource"
      matSort
      class="bordered-table"
    >
      <!-- Account No -->
      <ng-container matColumnDef="accountNo">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Account No</th>
        <td mat-cell *matCellDef="let t">
          <a
            class="account-link"
            (click)="navigateToRecurringDepositAccount($event, t)"
          >
            {{ t.accountNo }}
          </a>
        </td>
      </ng-container>

      <!-- Recurring Deposit Product -->
      <ng-container matColumnDef="productName">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          Recurring Deposit Product
        </th>
        <td mat-cell *matCellDef="let t">
          {{ t.recurringDepositProductName || t.productName }}
        </td>
      </ng-container>

      <!-- Client Name -->
      <ng-container matColumnDef="clientName">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Client Name</th>
        <td mat-cell *matCellDef="let t">
          <a
            class="client-link"
            (click)="navigateToClient($event, t)"
          >
            {{ t.clientName || 'â€”' }}
          </a>
        </td>
      </ng-container>

      <!-- Last Active -->
      <ng-container matColumnDef="lastActive">
        <th mat-header-cell *matHeaderCellDef>Last Active</th>
        <td mat-cell *matCellDef="let t">
          {{ getLastActive(t.lastActiveTransactionDate) }}
        </td>
      </ng-container>

      <!-- Balance -->
      <ng-container matColumnDef="balance">
        <th mat-header-cell *matHeaderCellDef>Balance</th>
        <td mat-cell *matCellDef="let t">
          {{ t.summary?.accountBalance | number: '1.0-2' }}
        </td>
      </ng-container>

      <!-- Header & Rows -->
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns" class="select-row"></tr>
    </table>

    <!-- ðŸ”¹ Paginator -->
    <mat-paginator
      [pageSize]="pageSize"
      [pageSizeOptions]="[5, 50, 100]"
      [length]="totalRows"
      showFirstLastButtons
    ></mat-paginator>

    <!-- ðŸ”¹ No Records -->
    <div *ngIf="!isLoading && dataSource.data.length === 0" class="no-records">
      No recurring deposit records found
    </div>
  </div>
</mat-card>
